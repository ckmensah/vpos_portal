

<div class="w3-container w3-white w3-hover-shadow col-md-10 offset-md-1 w3-card-4 w3-border w3-border-purple rcorners w3-center">
  <!--<div class="row">-->
  <h4 style="text-decoration: underline;"><strong>KINDLY CHOOSE SERVICE SETUP TYPES   </strong></h4>

  <div class="w3-responsive">
    <% if params[:modal_appear] == "to_multiple" %>
      <button type="button" class="btn btn-outline-purple div_tablink" style="font-size: small; width: 200px;" onclick="openTab(event, 'with_wallet')">SERVICE WITH WALLET</button>
<!--      <button type="button" class="btn btn-outline-purple div_tablink w3-vpos-purple" style="font-size: small; width: 220px;" onclick="openTab(event, 'without_wallet')">SERVICE WITHOUT WALLET</button>-->
      <% else %>
      <button type="button" class="btn btn-outline-purple div_tablink w3-vpos-purple" style="font-size: small; width: 200px;" onclick="openTab(event, 'with_wallet')">SERVICE WITH WALLET</button>
<!--      <button type="button" class="btn btn-outline-purple div_tablink" style="font-size: small; width: 220px;" onclick="openTab(event, 'without_wallet')">SERVICE WITHOUT WALLET</button>-->
      <% end %>

  </div>
  <br/><br/>

  <div id="with_wallet" class="div_class active">
    <%#= render :partial=> "region_master_index" %>

    <div class="">

      <div class="w3-white w3-hover-shadow col-md-10 offset-md-1 w3-card-4 w3-border w3-border-purple rcorners w3-center">
        <h4 class="show w3-center"><strong>New Merchant Services</strong></h4>

        <div class="w3-container">
          <br/>
          <%#= simple_form_for(@entity_division, :data => {:remote => true, count: params[:count], page: params[:page]}) do |f| %>
            <%= simple_form_for(@entity_division, url: entity_div_create_path(@entity_division, interface_type: params[:interface_type], entity_code: params[:entity_code], count1: params[:count1], page1: params[:page1], count: params[:count], page: params[:page] ),:remote => true) do |f| %>

              <%= f.error_notification %>
              <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

            <%#= f.input :allow_qr, label: false, as: :boolean, required: false, input_html: {id: "allow_qr", autocomplete: "off", class: "", style: "display: block; float: right; width: 50%"} %>

<!--            <div class="w3-center">-->
<!--              <div class="w3-half"><label>Allow QR</label></div>-->
<!--              <div class="w3-half">-->
                <%#= f.input :allow_qr, label: "Allow QR", as: :boolean, required: false, wrapper: :checkbox, input_html: {id: "allow_qr", autocomplete: "off", class: "", style: "display: block; float: right; width: 50%"} %>
<!--              </div>-->
<!--            </div>-->

<!--            <br/>-->
<!--            <div class="w3-container col-md-10 offset-md-1" style="width: 100%">-->
<!--              <div class="w3-quarter"><label>Card Option Status</label></div>-->
<!--              <div class="w3-quarter">-->
                <%#= f.input :card_option_status, label: false, as: :boolean, required: false, input_html: {id: "card_status", autocomplete: "off", class: "", style: "display: block; float: right; width: 50%"} %>
<!--              </div>-->
<!--              <div>-->
<!--                <div class="w3-quarter"><label>Payment Type</label></div>-->
<!--                <div class="w3-quarter">-->
                  <%#= f.input :payment_type, label: false, as: :boolean, required: false, input_html: {id: "payment_type", autocomplete: "off", class: "", style: "display: block; float: right; width: 50%"} %>
<!--                </div>-->
<!--              </div>-->

<!--              <div>-->
<!--                <div class="w3-quarter"><label>Reference</label></div>-->
<!--                <div class="w3-quarter">-->
                  <%#= f.input :reference, label: false, as: :boolean, required: false, input_html: {id: "reference", autocomplete: "off", class: "",checked: false, style: "display: block; float: right; width: 50%"} %>
<!--                </div>-->
<!--              </div>-->

<!--              <br><br>-->
<!--            </div>-->
            <div class="container-fluid col-md-10 justify-content-between form-inline">
            <%= f.input :allow_qr, label: "Allow QR", as: :boolean, required: false, wrapper: :inline_boolean, input_html: {id: "allow_qr", autocomplete: "off", class: "", style: "display: block; float: right; width: 50%"} %>
            <%= f.input :card_option_status, label: "Card Options Status", as: :boolean,wrapper: :inline_boolean, required: false, input_html: {id: "card_status", autocomplete: "off", class: "", style: "display: block; float: right; width: 50%"} %>
            <%= f.input :payment_type, label: "Payment Type", as: :boolean, required: false,wrapper: :inline_boolean, input_html: {id: "payment_type", autocomplete: "off", class: "", style: "display: block; float: right; width: 50%"} %>
            <%= f.input :reference, label: "Reference", as: :boolean, required: false,wrapper: :inline_boolean, input_html: {id: "reference", autocomplete: "off", class: "",checked: false, style: "display: block; float: right; width: 50%"} %>
            </div>
            <br><br>

            <div class="w3-third">

                <%= f.input :division_name, label: "Service Name", required: true, input_html: {id: "div_name", autofocus: true, autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                <%= f.input :division_alias, label: "Service Alias", required: true, input_html: {id: "div_alias", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                <%= f.input :activity_type_code, label: "Activity Code", collection: @activity_types, label_method: :activity_name, value_method: :assigned_code, required: true, input_html: {id: "activity_key", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                <%= f.input :service_code, as: :integer, label: "Shortcode Ext", required: true, input_html: {id: "serv_code", value: @service_code, autocomplete: "off", min: 1, max: 999999, oninput: "validity.valid||(value='');", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                <%= f.input :sms_sender_id, label: "SMS Sender ID", required: true, input_html: {id: "sender_id", value: @entity_division.sms_sender_id, autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%"} %>

              </div>


                <div class="w3-third">
                  <div id="min_amt_div">
                    <%= f.input :min_amount, as: :integer, label: "Minimum Amount", required: true, input_html: {id: "min_amt", autocomplete: "off", min: 0, max: 999999, class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                  </div>
                  <%= f.input :service_label, label: "Service Label", required: true, input_html: {id: "serv_label", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                  <%= f.input :region_name, label: "Region", collection: @region_masters, label_method: :region_name, value_method: :id, required: true, input_html:{id: "for_region", autocomplete: "off",class:"form-control w3-input w3-border w3-white input-group input-append",style:"width: 90%;"}  %>

                  <%= f.input :city_town_name, label: "City", collection: @city_masters, label_method: :city_town_name, value_method: :id, required: true, input_html:{id: "for_city", autocomplete: "off",class:"form-control w3-input w3-border w3-white input-group input-append",style:"width: 90%;"}  %>
                  <%= f.input :suburb_id, label: "Suburb", collection: @sub_masters, label_method: :suburb_name, value_method: :id, required: true, input_html:{id: "for_suburb", autocomplete: "off",class:"form-control w3-input w3-border w3-white input-group input-append",style:"width: 90%;"}  %>
<!--                  <div id="ref_label">-->
                    <%#= f.input :ref_label, label: "Reference Label", collection: [%w[Name name], ["Account Number", "Acct"],[""]], required: true, input_html: { id: "ref_label", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
<!--                  </div>-->
                  <div id="act_loc_div">
                    <%= f.input :activity_loc, label: "Activity Location", required: true, input_html: {id: "act_loc", autocomplete: "off", min: 0, max: 999999, class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                  </div>
                  <div id="extra_desc_div">
                    <%= f.input :extra_desc, as: :text, label: "Activity Description", required: true, input_html: {id: "extra_desc", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: "width: 90%;"} %>
                  </div>
                </div>


            <div class="w3-third">
              <%= f.input :comment, label: "Extra Ref.", required: true, input_html: {id: "extra_ref", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: ""} %>
              <%= f.input :serv_id, label: "Service ID", value_method: :id, required: true, input_html: {id: "serv_id", type: "number", min: "1", oninput: "validity.valid||(value='');", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: ""} %>
                <%#= ff.input :api_key,  label: "Sms Key", value_method: :id, required: true, input_html:{id: "api_key", autocomplete: "off",class:"form-control w3-input w3-border w3-white input-group input-append",style:"width: 90%; height: 25px"}  %>
                <%= f.input :s_key, as: :text, label: "Secret Key", required: true, input_html: {id: "k_secret", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: ""} %>
                <%= f.input :c_key, as: :text, label: "Client Key", required: true, input_html: {id: "k_client", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: ""} %>


                <%#= f.simple_fields_for :entity_wallet_configs do |fff| %>
                  <%#= fff.input :service_id, label: "Service ID", value_method: :id, required: true, input_html: {id: "serv_id", type: "number", min: "1", oninput: "validity.valid||(value='');", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: ""} %>
                  <%#= ff.input :api_key,  label: "Sms Key", value_method: :id, required: true, input_html:{id: "api_key", autocomplete: "off",class:"form-control w3-input w3-border w3-white input-group input-append",style:"width: 90%; height: 25px"}  %>
                  <%#= fff.input :secret_key, label: "Secret Key", required: true, input_html: {id: "k_secret", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: ""} %>
                  <%#= fff.input :client_key, label: "Client Key", required: true, input_html: {id: "k_client", autocomplete: "off", class: "form-control w3-input w3-border w3-white input-group input-append", style: ""} %>
                  <%#= fff.input :active_status, :as => :hidden, input_html: {value: true} %>
                  <%#= fff.input :del_status, :as => :hidden, input_html: {value: false} %>
                  <%#= fff.input :user_id, :as => :hidden, input_html:{value: current_user.id} %>
                <%# end %>

                <%#= f.input :comment, label: "Comment", :as => :text, required: false, input_html: {rows: 5, cols: 3, autocomplete: "off", class: "form-control w3-border ", style: ""} %>
              </div>
            <%= f.input :entity_code, :as => :hidden, input_html: {value: params[:entity_code]} %>
              <%= f.input :link_master, :as => :hidden, input_html: {value: false} %>
              <%= f.input :del_status, :as => :hidden, input_html: {value: false} %>
              <%= f.input :active_status, :as => :hidden, input_html:{value: true} %>
              <%= f.input :user_id, :as => :hidden, input_html:{value: current_user.id} %>
              <div>
                <%= f.submit "Submit", class: "w3-button w3-purple-vpos w3-border w3-border-purple w3-small w3-round-large", :data => {:disable_with => 'Please Wait...'}, style: "width:auto;float:center;", remote: true %>
                <% if params[:interface_type] == "info" %>
                  <%= link_to 'Back', entity_index_path(entity_code: params[:entity_code], filter_main1: session[:merchant_filter].present? ? session[:merchant_filter].to_enum.to_h : "", page: params[:page], count: params[:count]), class: "w3-button w3-white w3-border w3-border-purple w3-small w3-round-large", remote: true %>
                <% else %>
                  <%= link_to 'Back', entity_division_index_path(entity_code: params[:entity_code], service_filter: session[:service_filter].present? ? session[:service_filter].to_enum.to_h : "", count1: params[:count1], page1: params[:page1], page: params[:page], count: params[:count]), class: "w3-button w3-white w3-border w3-border-purple w3-small w3-round-large", remote: true %>
                <% end %>
              </div>
            <% end %>
            <br/>
            </div>


            </div>

            </div>


            <div class="col-md-7 col-md-offset-5">
            </div>

  </div>
  <br>


  <div id="without_wallet" class="div_class" style="display:none">
    <%#= render :partial=> "/city_town_masters/city_town_master_index" %>

    <div class="">

      <div class="w3-white w3-hover-shadow  w3-card-4 w3-border w3-border-purple rcorners w3-center">
        <h4 class="show w3-center"><strong>New Merchant Services</strong></h4>
        <div id="division_new"></div>

        <div class="w3-container">
          <% unless params[:display_cnt].present?  %>
            <br>
            <div>
              <!--<div class="w3-half">-->

              <!--</div>-->
              <div class="w3-half" id="div_num_id" >

                <%= select_tag :display_cnt, options_for_select([0,1,2,3,4,5,6,7,8,9,10], params[:display_cnt].to_i),
                               :onchange => "divisionNumber()",
                               :data => {  :remote => true, :url => url_for(params:{
                                   modal_appear: "to_multiple",
                                   into_create: params[:into_create],
                                   interface_type: params[:interface_type],
                                   entity_code: params[:entity_code]},
                                                                            :controller => "entity_divisions", :action => "new")},
                               id:"record", class: "w3-button w3-white w3-border w3-border-purple w3-round-large",
                               style: "width:auto; height:35px; float:right", remote:true %>
                <h5><strong>Please select the number of services to add: </strong></h5>
              </div>


            </div>

            <br>
          <% end %>
          <%= simple_form_for(@entity_division, url: entity_divisions_path(@entity_division, modal_appear: "to_multiple", interface_type: params[:interface_type], display_cnt: params[:display_cnt], entity_code: params[:entity_code], count1: params[:count1], page1: params[:page1], count: params[:count], page: params[:page] ),:remote => true) do |f| %>
            <%= f.input :link_master, :as => :hidden, input_html: {value: true} %>
            <%= f.input :entity_code, :as => :hidden, input_html: {value: params[:entity_code]} %>
            <%= f.input :active_status, :as => :hidden, input_html: {value: true} %>
            <%= f.input :del_status, :as => :hidden, input_html: {value: false} %>
            <%= f.input :user_id, :as => :hidden, input_html:{value: current_user.id} %>

            <div class="pre-scrollable table-responsive-md" style="max-height: 50vh">
              <table class="w3-table-all table-bordered w3-hoverable w3-card-4">

                <thead>

                <tr class="w3-vpos-purple">
                  <th><strong>No.</strong></th>
                  <th><strong>QR</strong></th>
                  <th><strong>Service Name</strong></th>
                  <th><strong>Service Alias</strong></th>
                  <!--<th><strong>Name &emsp;&emsp;&emsp;&emsp;</strong></th>-->
                  <th><strong>Short Code Ext</strong></th>
                  <th><strong>Service Label</strong></th>
                  <th><strong>Sender ID</strong></th>
                  <th><strong>Activity Type</strong></th>
                  <th><strong>Region</strong></th>
                  <th><strong>City</strong></th>
                  <th><strong>Suburb</strong></th>
                  <!--<th><strong>Save</strong></th>-->

                  <!--<th colspan="1"></th>-->
                </tr>
                </thead>
                <tbody>
                <% if params[:into_create] == "into_create" %>
                  <% logger.info "FIRST +=============================================================" %>
                  <% count = 1 %>
                  <% @display.times.each do |value| %>
                    <% the_params = value %>
                    <%# logger.info "key: #{key.inspect}; value: #{value.inspect}; inner value: #{value["activity_type_code"].inspect}" %>
                    <%# act_type = ActivityType.where(assigned_code: the_params["activity_type_code"], active_status: true).last %>
                    <tr>
                      <td><strong><%= count %></strong></td>
                      <td><strong><input type="checkbox" name="divisions[<%= count %>[allow_qr]]" autocomplete="off" class="boolean optional " style="display: block;" /></strong></td>

                      <td><strong><input type="text" name="divisions[<%= count %>[division_name]]" autocomplete="off" placeholder="Division Name" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                      <td><strong><input type="text" name="divisions[<%= count %>[division_alias]]" autocomplete="off" placeholder="Division Alias" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                      <td><strong><input type="number" name="divisions[<%= count %>[service_code]]" autocomplete="off" min="1" max="999999" oninput="validity.valid||(value='');" placeholder="Service Code" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                      <td><strong><input type="text" name="divisions[<%= count %>[service_label]]" autocomplete="off" placeholder="Service Name" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                      <td><strong><input type="text" name="divisions[<%= count %>[sms_sender_id]]" autocomplete="off" placeholder="Sender ID" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>

                      <td style=""><strong><%= collection_select :divisions, "#{count}[activity_type_code]", @activity_types, :id, :activity_name, { :prompt => 'Select an Activity type', :include_blank => true}, {id: "act_type_#{count}", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                      <td style=""><strong><%= collection_select :divisions, "#{count}[region_name]", @region_masters, :id, :region_name, {:prompt => 'Select a Region', :include_blank => false}, {id: "for_region_#{count}", :onchange => "changeCity('for_region_#{count}', 'for_city_#{count}', 'for_suburb_#{count}')", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                      <td style=""><strong><%= collection_select :divisions, "#{count}[city_town_name]", @city_town_masters, :id, :city_town_name, {:prompt => 'Select a City/Town', :include_blank => false}, {id: "for_city_#{count}", :onchange => "changeSuburb('for_city_#{count}', 'for_suburb_#{count}')", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                      <td style=""><strong><%= collection_select :divisions, "#{count}[suburb_id]", @suburb_masters, :id, :suburb_name, {:prompt => 'Select a Suburb', :include_blank => false}, {id: "for_suburb_#{count}",class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>

                      <!--<input type="hidden" name="divisions[<%#= count %>[activity_type_code]]]" value="<%#= act_type.assigned_code %>" >-->

                      <!--<td><strong><input type="checkbox" name="the_list[<%#= count %>[checkbox]]]" style="display: block;">-->
                      <!--<input type="hidden" name="the_list[<%#= count %>[id]]]" value="<%#= person.last %>"><%# count = count + 1%></strong></td>-->
                      <!--<input type="hidden" name="the_activity_wallets[<%#= count %>[id]]]" >-->
                      <% count = count + 1%>
                    </tr>
                  <% end %>
                <% else %>
                  <% logger.info "SECOND +=============================================================" %>
                  <% count = 1 %>
                  <!--list.each do |row|-->
                  <!--the_params = row[1]-->
                  <% display_size = @display.nil? ? 0 : @display.to_enum.to_h.length.to_i %>
                  <% if @display != nil %>
                    <% @display.each do |key, value| %>
                      <% the_params = value %>
                      <%
                          the_params[:region_name].present? ? @city_town_masters = CityTownMaster.where(active_status: true, region_id: the_params[:region_name]).order(city_town_name: :asc) : @city_town_masters = CityTownMaster.where(id: 0)
                          the_params[:city_town_name].present? ? @suburb_masters = SuburbMaster.where(active_status: true, city_town_id: the_params[:city_town_name]).order(suburb_name: :asc) : @suburb_masters = SuburbMaster.where(id: 0)
                      %>
                      <%# pcs_do = ActivityType.where(id: the_params[:id]).last %>
                      <tr>
                        <td><strong><%= count %></strong></td>
                        <% if the_params.key?("allow_qr") && the_params["allow_qr"] == "on" %>
                          <td><strong><input type="checkbox" name="divisions[<%= count %>[allow_qr]]" checked autocomplete="off" class="boolean optional " style="display: block;" /></strong></td>
                        <% else %>
                          <td><strong><input type="checkbox" name="divisions[<%= count %>[allow_qr]]" autocomplete="off" class="boolean optional " style="display: block;" /></strong></td>
                        <% end %>
                        <td><strong><input type="text" name="divisions[<%= count %>[division_name]]" value="<%= the_params["division_name"] %>" autocomplete="off" placeholder="Division Name" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                        <td><strong><input type="text" name="divisions[<%= count %>[division_alias]]" value="<%= the_params["division_alias"] %>" autocomplete="off" placeholder="Division Alias" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                        <td><strong><input type="number" name="divisions[<%= count %>[service_code]]" value="<%= the_params["service_code"] %>" autocomplete="off" min="1" max="999999" oninput="validity.valid||(value='');" placeholder="Service Code" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                        <td><strong><input type="text" name="divisions[<%= count %>[service_label]]" value="<%= the_params["service_label"] %>" autocomplete="off" placeholder="Service Name" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                        <td><strong><input type="text" name="divisions[<%= count %>[sms_sender_id]]" value="<%= the_params["sms_sender_id"] %>" autocomplete="off" placeholder="Sender ID" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>

                        <td style=""><strong><%= collection_select :divisions, "#{count}[activity_type_code]", @activity_types, :id, :activity_name, { :prompt => 'Select an Activity type', :include_blank => true, selected: "#{the_params["activity_type_code"]}"}, {id: "act_type_#{count}", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                        <td style=""><strong><%= collection_select :divisions, "#{count}[region_name]", @region_masters, :id, :region_name, { :prompt => 'Select a Region', :include_blank => false, selected: "#{the_params["region_name"]}"}, {id: "for_region_#{count}", :onchange => "changeCity('for_region_#{count}', 'for_city_#{count}', 'for_suburb_#{count}')", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                        <td style=""><strong><%= collection_select :divisions, "#{count}[city_town_name]", @city_town_masters, :id, :city_town_name, { :prompt => 'Select a City/Town', :include_blank => false, selected: "#{the_params["city_town_name"]}"}, {id: "for_city_#{count}", :onchange => "changeSuburb('for_city_#{count}', 'for_suburb_#{count}')", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                        <td style=""><strong><%= collection_select :divisions, "#{count}[suburb_id]", @suburb_masters, :id, :suburb_name, {:prompt=> "Select a Suburb",  :include_blank => false, selected: "#{the_params["suburb_id"]}"}, {id: "for_suburb_#{count}",class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>

                        <!--<td><strong><input type="checkbox" name="the_list[<%#= count %>[checkbox]]]" style="display: block;">-->
                        <!--<input type="hidden" name="the_list[<%#= count %>[id]]]" value="<%#= person.last %>"><%# count = count + 1%></strong></td>-->
                        <!--<input type="hidden" name="the_activity_wallets[<%#= count %>[id]]]" >-->
                        <% count = count + 1%>
                      </tr>
                    <% end %>
                    <% if display_size < @display_length.to_i %>
                      <% logger.info "THIRD +=============================================================" %>
                      <%# count =  %>
                      <% new_display = @display_length.to_i - display_size %>
                      <% new_display.times.each do |val| %>
                        <tr>
                          <td><strong><%= count %></strong></td>
                          <td><strong><input type="checkbox" name="divisions[<%= count %>[allow_qr]]" autocomplete="off" class="boolean optional" style="display: block;" /></strong></td>

                          <td><strong><input type="text" name="divisions[<%= count %>[division_name]]" autocomplete="off" placeholder="Division Name" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                          <td><strong><input type="text" name="divisions[<%= count %>[division_alias]]" autocomplete="off" placeholder="Division Alias" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                          <td><strong><input type="number" name="divisions[<%= count %>[service_code]]" autocomplete="off" min="1" max="999999" oninput="validity.valid||(value='');" placeholder="Service Code" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                          <td><strong><input type="text" name="divisions[<%= count %>[service_label]]" autocomplete="off" placeholder="Service Name" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>
                          <td><strong><input type="text" name="divisions[<%= count %>[sms_sender_id]]" autocomplete="off" placeholder="Sender ID" class="form-control w3-input w3-border w3-white input-group input-append" style="" /></strong></td>

                          <td style=""><strong><%= collection_select :divisions, "#{count}[activity_type_code]", @activity_types, :id, :activity_name, { :prompt => 'Select an Activity type', :include_blank => true, selected: "#{the_params["activity_type_code"]}"}, {id: "act_type_#{count}", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                          <td style=""><strong><%= collection_select :divisions, "#{count}[region_name]", @region_masters, :id, :region_name, { :prompt => 'Select a Region', :include_blank => false, selected: "#{the_params["region_name"]}"}, {id: "for_region_#{count}", :onchange => "changeCity('for_region_#{count}', 'for_city_#{count}', 'for_suburb_#{count}')", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                          <td style=""><strong><%= collection_select :divisions, "#{count}[city_town_name]", @city_town_masters, :id, :city_town_name, { :prompt => 'Select a City/Town', :include_blank => false, selected: "#{the_params["city_town_name"]}"}, {id: "for_city_#{count}", :onchange => "changeSuburb('for_city_#{count}', 'for_suburb_#{count}')", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                          <td style=""><strong><%= collection_select :divisions, "#{count}[suburb_id]", @suburb_masters, :id, :suburb_name, {:prompt=> "Select a Suburb",  :include_blank => false, selected: "#{the_params["suburb_id"]}"}, {id: "for_suburb_#{count}", class:"form-control w3-input w3-border w3-white input-group input-append", style:"" } %></strong></td>
                          <% count = count + 1%>
                        </tr>
                      <% end %>
                    <% end %>
                  <% end %>


                <% end %>

                </tbody>

              </table>
            </div>
            <br>
            <div>
              <%= f.submit "Submit", class: "w3-button w3-purple-vpos w3-border w3-border-purple w3-small w3-round-large", :data => {:disable_with => 'Please Wait...'}, style: "width:auto;float:center;", remote: true %>
              <% if params[:interface_type] == "info" %>
                <%= link_to 'Back', entity_index_path(entity_code: params[:entity_code], filter_main1: $merchant_filter.present? ? $merchant_filter.to_enum.to_h : "", count1: params[:count1], page1: params[:page1], page: params[:page], count: params[:count]), class: "w3-button w3-white w3-border w3-border-purple w3-small w3-round-large", remote: true %>
              <% else %>
                <%= link_to 'Back', entity_division_index_path(entity_code: params[:entity_code], service_filter: session[:service_filter].present? ? session[:service_filter].to_enum.to_h : "", count1: params[:count1], page1: params[:page1], page: params[:page], count: params[:count]), class: "w3-button w3-white w3-border w3-border-purple w3-small w3-round-large", remote: true %>
              <% end %>
            </div>

          <% end %>
          <br/>
        </div>



      </div>

    </div>


    <div class="col-md-7 col-md-offset-5">
    </div>


  </div>
  <br><br>


  <!--</div>-->
</div>























<script>

    function openTab(evt, cityName) {
        var i, x, tablinks;
        x = document.getElementsByClassName("div_class");
        for (i = 0; i < x.length; i++) {
            x[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("div_tablink");
        for (i = 0; i < x.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" w3-vpos-purple", "");
        }


        document.getElementById(cityName).style.display = "block";
        evt.currentTarget.className += " w3-vpos-purple";
    }

    <% if params[:modal_appear] == "to_multiple" %>
    document.getElementById("without_wallet").style.display = "block";
    document.getElementById("with_wallet").style.display = "none";
    <% end %>

    function changeCity(for_region_id, for_city_id, for_suburb_id) {
        var region_id = $('#' + for_region_id);
        var city_id = $('#' + for_city_id);
        console.log("For region id:: " + region_id.val() + "For city id :: " + city_id);
        city_id.attr("title", "Secondly select a city after region selection!");

            console.log("For region id:: " + region_id.val());
            city_id.attr("title", "Now select a city/town!");

            Rails.ajax({
                type: "POST",
                url: "<%= suburb_city_ajax_call_path %>",
//                data: "id_for_region=" + region_id.val(),
                data: "id_for_region=" + region_id.val() + "&city_id_name=" + for_city_id + "&suburb_id_name=" + for_suburb_id,
                dataType: "script"
            });

    }


    function changeSuburb(for_city_id, for_suburb_id) {
        var city_id = $('#' + for_city_id);
        var suburb_id = $('#' + for_suburb_id);
        console.log("For city id:: " + city_id.val() + "For suburb id :: " + suburb_id);
        suburb_id.attr("title", "Secondly select a suburb after city/town selection!");

        console.log("For region id:: " + city_id.val());
        suburb_id.attr("title", "Now select a suburb!");

        Rails.ajax({
            type: "POST",
            url: "<%= general_suburb_ajax_call_path %>",
//                data: "id_for_region=" + region_id.val(),
            data: "id_for_city_town=" + city_id.val() + "&suburb_id_name=" + for_suburb_id,
            dataType: "script"
        });

    }

    function divisionNumber() {
        document.getElementById("div_num_id").style.display = "none";
    }

    $(document).ready(function(){


        $('[data-toggle="tooltip"]').tooltip();
        var region_id = $('#for_region');
        var city_id = $("#for_city");
        var suburb_id = $("#for_suburb");
        var activity_type_id = $("#activity_key");
//    district_id.attr("title", "First select a district!");
        city_id.attr("title", "Secondly select a city after region selection!");

        // if (activity_type_id.val() === "DON") {
        //     document.getElementById("min_amt_div").style.display = "block";
        // } else {
        //     document.getElementById("min_amt_div").style.display = "none";
        //     document.getElementById("min_amt").value = "";
        // }

        if (activity_type_id.val() === "DON") {
            document.getElementById("min_amt_div").style.display = "block";
            document.getElementById("extra_desc_div").style.display = "none";
            document.getElementById("act_loc_div").style.display = "none";
            document.getElementById("extra_desc").value = "";
            document.getElementById("act_loc").value = "";
        } else if (activity_type_id.val() === "SHW") {
            document.getElementById("extra_desc_div").style.display = "block";
            document.getElementById("act_loc_div").style.display = "block";
            document.getElementById("min_amt_div").style.display = "none";
            document.getElementById("min_amt").value = "";
        }
        else {
            document.getElementById("extra_desc_div").style.display = "none";
            document.getElementById("act_loc_div").style.display = "none";
            document.getElementById("min_amt_div").style.display = "none";
            document.getElementById("min_amt").value = "";
            document.getElementById("extra_desc").value = "";
            document.getElementById("act_loc").value = "";
        }

        region_id.change(function() {
            console.log("For region id:: " + region_id.val());
//      $('[data-toggle="tooltip"]').tooltip();
//      city_id.attr("disabled", false);
            city_id.attr("title", "Now select a city/town!");

            Rails.ajax({
                type: "POST",
                url: "<%= suburb_city_ajax_call_path %>",
                data: "id_for_region=" + region_id.val(),
                dataType: "script"
            });

//            fetch("<%#= suburb_city_ajax_call_path %>", {
//                method: 'post',
//                body: JSON.stringify({id_for_region: region_id.val()}),
//                headers: {
//                    'Content-Type': 'application/json',
//                    'X-CSRF-Token': Rails.csrfToken()
//                },
//                dataType: "script",
//                credentials: 'same-origin'
//            }).then(function(response) {
//                return response.json();
//            }).then(function(data) {
//                console.log(data);
//            });


        });

        city_id.change(function() {
            console.log("For city_town id:: " + city_id.val());
//      $('[data-toggle="tooltip"]').tooltip();
//      city_id.attr("disabled", false);
            suburb_id.attr("title", "Now select a suburb!");

            Rails.ajax({
                type: "POST",
                url: "<%= general_suburb_ajax_call_path %>",
                data: "id_for_city_town=" + city_id.val(),
                dataType: "script"
            });

        });

        activity_type_id.change(function() {
            if (activity_type_id.val() === "DON") {
                console.log("For Donations ==========================");
                document.getElementById("min_amt_div").style.display = "block";
                document.getElementById("extra_desc_div").style.display = "none";
                document.getElementById("act_loc_div").style.display = "none";
                document.getElementById("extra_desc").value = "";
                document.getElementById("act_loc").value = "";
            } else if (activity_type_id.val() === "SHW") {
                console.log("For Show ==========================");
                document.getElementById("extra_desc_div").style.display = "block";
                document.getElementById("act_loc_div").style.display = "block";
                document.getElementById("min_amt_div").style.display = "none";
                document.getElementById("min_amt").value = "";
            }
            else {
                document.getElementById("extra_desc_div").style.display = "none";
                document.getElementById("act_loc_div").style.display = "none";
                document.getElementById("min_amt_div").style.display = "none";
                document.getElementById("min_amt").value = "";
                document.getElementById("extra_desc").value = "";
                document.getElementById("act_loc").value = "";
            }
        });

    });

</script>







